<div #gameContainer class="game-container">
  <div class="game-board" [style.width.px]="boardWidth" [style.height.px]="boardHeight">
    <div class="word-row" *ngFor="let word of gameService.board; let i = index" [style.height.px]="wordRowHeight"
      [ngClass]="{ 'highlighted': gameService.selectedWord === i }">
      
      <!-- Left side holds the hint button -->
      <div class="letter-box icon" [style.width.px]="letterBoxSize * .85" [style.height.px]="letterBoxSize * .85" [style.font-size.px]="iconFontSize"
      *ngIf="hintsEnabled()">
        <fa-icon *ngIf="gameService.selectedWord === i && !word.solved" class="hint" [icon]="faLightbulb" (click)="hint()"></fa-icon>
      </div>

      <!-- The letters of the word -->
      <div class="letter-box letter" [style.font-size.px]="letterFontSize"
      [style.width.px]="letterBoxSize" [style.height.px]="letterBoxSize"
        *ngFor="let letter of word.letters; let j = index" (click)="setSelectedCell(i, j)"
        [ngClass]="{ shake: word.wrong, bounceSize: word.solved,
          'locked': word.locked == true,
          'solved': word.solved == true,
          'wrong': word.wrong == true,
          'highlighted':
            gameService.selectedWord === i &&
            gameService.selectedLetter === j,
          'on-path':
            i > 0 &&
            gameService.board[i - 1].letters[j] &&
            letter != gameService.board[i - 1].letters[j] &&
            letter != null
        }">
        {{ letter }}
        <!-- Spinner while the letter is loading -->
        <fa-icon *ngIf="word.loading == true" class="icon testing fa-spin" [style.font-size.px]="iconFontSize" [icon]="faSpinner"></fa-icon>

        <!-- Frowny face if the game is broken -->
        <fa-icon *ngIf="word.locked && gameService.gameStatus == enumGameStatus.Broken" class="icon" [icon]="faFaceFrown"></fa-icon>
      </div>

      <!-- The rest of these are icons depending on the word -->
      <div class="letter-box" [style.width.px]="letterBoxSize * .85" [style.height.px]="letterBoxSize * .85" [style.font-size.px]="iconFontSize">

        <!-- Locked word, either invisible/timer icon (at bottom) or reload icon (at top) -->
        <!-- New game at top -->
        <fa-icon class="icon"
          [ngClass]="{
            win: gameService.gameStatus == enumGameStatus.Initialize,
            broken: gameService.gameStatus == enumGameStatus.Broken,
            unverified: gameService.gameStatus == enumGameStatus.Run,
            'fa-spin': gameService.gameStatus == enumGameStatus.Initialize
          }"
          *ngIf="word.locked && i === 0" (click)="newGame()" [icon]="faRepeat"></fa-icon>

        <!-- Timer at bottom -->
        <div class="timer"
          [ngClass]="{
            high: !gameService.timeExpired && gameService.timeRemaining >= 10000,
            medium: !gameService.timeExpired && gameService.timeRemaining >= 5000 && gameService.timeRemaining < 10000,
            low: !gameService.timeExpired && gameService.timeRemaining < 5000,
            expired: gameService.timeExpired
          }"
          *ngIf="word.locked && i != 0 && gameService.gameMode == enumGameMode.Timed">
          {{ formatTimer(gameService.timeRemaining) }}
        </div>

        <!-- Unverified word -->
        <fa-icon *ngIf="
          !word.locked &&
          word.populated &&
          !word.solved &&
          !word.wrong &&
          !word.testing &&
          !word.broken
        " class="unverified" (click)="testWord(i)" [icon]="faCircleQuestion"></fa-icon>

        <!-- Solved word -->
        <fa-icon *ngIf="!word.locked && word.solved" class="solved" (click)="testWord(i)" [icon]="faCircleCheck"></fa-icon>

        <!-- Wrong word -->
        <fa-icon *ngIf="!word.locked && word.wrong" class="wrong" (click)="testWord(i)" [icon]="faCircleExclamation"></fa-icon>

        <!-- Testing word -->
        <fa-icon *ngIf="!word.locked && word.testing" class="testing fa-spin" (click)="testWord(i)" [icon]="faSpinner"></fa-icon>

        <!-- Broken word -->
        <fa-icon *ngIf="!word.locked && word.broken" class="broken" (click)="testWord(i)" [icon]="faCircleXmark"></fa-icon>
        
        <!-- No icon -->
        <div *ngIf="
            !word.locked &&
            !word.populated &&
            !word.solved &&
            !word.wrong &&
            !word.testing &&
            !word.broken
        ">
        </div>
      </div>
    </div>
  </div>
</div>